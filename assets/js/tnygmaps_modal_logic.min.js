function get_marker_image(){switch(mapMarkerReturn=jQuery("select[id=mapMarker]").val()){case"default":mapMarkerImageReturn=markerCustom;break;case"google":mapMarkerImageReturn="";break;case"custom":mapMarkerImageReturn=jQuery("#mapMarkerImage").val();break}return mapMarkerImageReturn}function seed_vars(){lat=jQuery("input#mapLat").val(),lng=jQuery("input#mapLng").val(),mapZoomReturn=parseInt(jQuery("select[id=mapZoom]").val(),10),mapWidthReturn=jQuery("input[id=mapWidth]").val(),mapHeightReturn=jQuery("input[id=mapHeight]").val(),mapTypeReturn=jQuery("select[id=mapType]").val(),locGooglePlaceID=jQuery("input#locGooglePlaceID").val(),mapAddressReturn=jQuery("input[id=mapAddress]").val(),locName=jQuery("input#locName").val(),locPhone=jQuery("input#locPhone").val(),locStreet=jQuery("input#locStAdr").val(),locCity=jQuery("input#locCity").val(),locRegion=jQuery("input#locRegion").val(),locPostcode=jQuery("input#locPostcode").val(),locCountry=jQuery("input#locCountry").val(),locWeb=jQuery("input#locWebsite").val(),locIcon="",locIcon=jQuery("input#locIconURL").val(),mapMarkerImageReturn=get_marker_image(),mapControlsReturn="true"===jQuery("select[id=mapControls]").val()}function clean_html(e){return e=String(e).replace(/'/g,'"'),jQuery.htmlClean(e,{removeTags:["script"],allowedAttributes:[["style"],["href",["a"]],["target",["a"]],["title",["a"]]],allowedTags:["p","a","span","ul","ol","li","br","hr","em","strong"],format:!1})}function processAddressObject(e,o){for(var t="",n=0;n<o.length;n++){var a=o[n];t+=a.types[0]===e?a.long_name:""}return t}function custom_location(){jQuery("#mapAddress").val(""),jQuery("#locGooglePlaceID").val(""),jQuery("#locIconURL").val(""),jQuery("#mapLat").val(""),jQuery("#mapLng").val("")}function initialize(e){function o(e){jQuery(e).find("input, textarea").first()}function t(e,o){o+=" alert",jQuery("#search-report").each(function(){jQuery(this).addClass(o),jQuery(this).width(jQuery(this).parent().width()-15),jQuery(this).append(e),jQuery("#search-report").fadeIn(800).delay(300).fadeOut(800,function(){jQuery(this).removeClass(o).empty()})})}function n(e,o,t,n,a,r,l,c,s,i){var d=""!==e?"max-width: 150px; ":"max-width: 200px; ";return infowindowPlace='<div class="marker-inside"  style="hight:auto;" >',infowindowPlace+="<b>"+o+"</b>",infowindowPlace+="<table>",infowindowPlace+="<tbody>",infowindowPlace+="<tr>",infowindowPlace+="<td>",infowindowPlace+='<div class="infowidow-address" style="'+d+'" >',infowindowPlace+=null!==t&&void 0!==t&&""!==t?"<div>"+t+"</div>":"",infowindowPlace+=null!==n&&void 0!==n&&""!==n?"<div>"+n+", ":"<div>",infowindowPlace+=null!==a&&void 0!==a&&""!==a?a+"</div>":"</div>",infowindowPlace+=null!==r&&void 0!==r&&""!==r?"<div>"+r+"</div>":"</div>",infowindowPlace+=null!==l&&void 0!==l&&""!==l?"<div>"+l+"</div>":"</div>",infowindowPlace+=null!==c&&void 0!==c&&""!==c?"<div>"+c+"</div>":"",infowindowPlace+=null!==s&&void 0!==s&&""!==s?'<div style="max-width: 100%; white-space: nowrap; width: 100%; overflow: hidden;  -o-text-overflow: ellipsis;  text-overflow: ellipsis;"><a href="'+s+'" class="gmap_link" target="_blank" style="">'+s+"</a></div>":"",infowindowPlace+="</div>",infowindowPlace+="</td>",infowindowPlace+="<td>",infowindowPlace+="</td>",infowindowPlace+="</tr>",infowindowPlace+="</tbody>",infowindowPlace+="</table>",infowindowPlace+="</div>",infowindowPlace+=null!==i&&void 0!==i&&""!==i?'<div class="marker-extras" style="border-top: 1px dotted #949494; margin-top: 5px; max-width: 265px; min-height: 40px; overflow: hidden; white-space: pre-wrap;" >'+mapInfoWindowReturn+"</div>":""}function a(){var o;seed_vars(),o=""!==lat&&""!==lng?new google.maps.LatLng(lat,lng):new google.maps.LatLng(43.703793,-72.326187),mapOptions={center:o,zoom:mapZoomReturn,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,streetViewControl:!1,panControl:!1,disableDefaultUI:mapControlsReturn},map=new google.maps.Map(document.getElementById("map_canvas"),mapOptions),d(),marker=new google.maps.Marker({position:o,map:map,icon:mapMarkerImageReturn}),infowindowPlace=n(locIcon,locName,locStreet,locCity,locRegion,locPostcode,locCountry,locPhone,locWeb,mapInfoWindowReturn),e.setContent(infowindowPlace),""!==locName&&e.open(map,marker),google.maps.event.addListener(marker,"click",function(){""!==locName&&e.open(map,marker)}),r()}function r(){google.maps.event.addDomListener(document.getElementById("locName"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locPhone"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locStAdr"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locCity"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locRegion"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locPostcode"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locCountry"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("locWebsite"),"change",custom_location),google.maps.event.addDomListener(document.getElementById("lookup-detials"),"click",f),google.maps.event.addDomListener(document.getElementById("map-update"),"click",u),google.maps.event.addDomListener(document.getElementById("mapControls"),"change",a),google.maps.event.addDomListener(document.getElementById("mapType"),"change",d),google.maps.event.addListener(map,"maptypeid_changed",m),google.maps.event.addDomListener(document.getElementById("mapInfoWindow"),"change",u),google.maps.event.addDomListener(document.getElementById("mapInfoWindow"),"click",p),setInterval(function(){g(jQuery("#mapInfoWindow").val())},100),google.maps.event.addDomListener(document.getElementById("mapMarker"),"change",y),google.maps.event.addDomListener(document.getElementById("mapMarkerImage"),"change",y),google.maps.event.addDomListener(document.getElementById("mapZoom"),"change",s),google.maps.event.addListener(map,"zoom_changed",i),google.maps.event.addListener(w,"place_changed",v),c()}function l(){!1===tnygmaps_api?spinner.stop():(spinner.stop(),jQuery("div#overlay").fadeOut(300,function(){jQuery(this).remove()}))}function c(){google.maps.event.addListener(marker,"click",function(){""!==mapInfoWindowReturn&&e.open(map,marker)})}function s(){mapZoomReturn=parseInt(jQuery("select[id=mapZoom]").val(),10),mapCurrCenter=map.getCenter(),map.setZoom(mapZoomReturn),map.setCenter(mapCurrCenter)}function i(){var e=map.getZoom();mapCurrCenter=map.getCenter(),map.setCenter(mapCurrCenter),jQuery("select[id=mapZoom] option").filter(function(){return jQuery(this).text()===e}).prop("selected",!0)}function d(){mapTypeReturn=jQuery("select[id=mapType]").val(),"ROADMAP"===mapTypeReturn?map.setMapTypeId(google.maps.MapTypeId.ROADMAP):"SATELLITE"===mapTypeReturn?map.setMapTypeId(google.maps.MapTypeId.SATELLITE):"HYBRID"===mapTypeReturn?map.setMapTypeId(google.maps.MapTypeId.HYBRID):"TERRAIN"===mapTypeReturn&&map.setMapTypeId(google.maps.MapTypeId.TERRAIN)}function m(){var e=map.getMapTypeId();e=e.toUpperCase(),jQuery("select[id=mapType] option").filter(function(){return jQuery(this).text()===e}).prop("selected",!0)}function u(){seed_vars(),mapInfoWindowReturn=jQuery("textarea#mapInfoWindow").val(),mapInfoWindowReturn="null"!==mapInfoWindowReturn&&""!==mapInfoWindowReturn&&null!==mapInfoWindowReturn?clean_html(mapInfoWindowReturn):"",infowindowPlace=n(locIcon,locName,locStreet,locCity,locRegion,locPostcode,locCountry,locPhone,locWeb,mapInfoWindowReturn),e.setContent(infowindowPlace),jQuery("textarea#mapInfoWindow").prop("disabled",!0).addClass("highlight alert").delay(700).show(1,function(){jQuery(this).val(mapInfoWindowReturn).removeClass("highlight alert").prop("disabled",!1),jQuery(this)[0].selectionStart=jQuery(this)[0].selectionEnd=jQuery(this).val().length}),e.open(map,marker)}function p(){if(jQuery("#mapInfoWindow").is(":visible")){jQuery(".marker-extras").length>0||(seed_vars(),infowindowPlace=n(locIcon,locName,locStreet,locCity,locRegion,locPostcode,locCountry,locPhone,locWeb,"..."),e.setContent(infowindowPlace));var o=null;jQuery(document).on("keydown","#mapInfoWindow",function(){o&&clearTimeout(o),o=setTimeout(u,3e3)})}e.open(map,marker)||e.open(map,marker)}function g(e){var o=jQuery(".marker-extras").html();o!==e&&(o=clean_html(e)),jQuery(".marker-extras").html(o)}function y(){markerImage=get_marker_image(),marker.setIcon(markerImage),null!==locPlace&&marker.setPosition(locPlace.geometry.location),marker.setMap(map)}function v(){e.close(),j.className="";var o=w.getPlace();if(!o.geometry)return void(j.className="notfound");if(o.geometry.viewport?(map.fitBounds(o.geometry.viewport),mapCurrCenter=map.getCenter()):(map.setCenter(o.geometry.location),map.setZoom(parseFloat(mapZoomReturn)),mapCurrCenter=map.getCenter()),o.address_components){locName="",locStreetNum="",locStreet="",locCity="",locRegion="",locPostcode="",locCountry="",locIcon="",locPhone="",locWeb="",lat="",lng="",locGooglePlaceID="",locGooglePlaceID=o.place_id?o.place_id:"",jQuery("#locGooglePlaceID").val(locGooglePlaceID.trim()),lat=o.geometry.location.lat(),jQuery("#mapLat").val(lat),lng=o.geometry.location.lng(),jQuery("#mapLng").val(lng),locName=o.name,jQuery("#locName").val(locName),locIcon=o.icon,jQuery("#locIconURL").val(locIcon.trim()),locPhone=o.formatted_phone_number,jQuery("#locPhone").val(locPhone),locWeb=o.website,jQuery("#locWebsite").val(locWeb);var t=processAddressObject("premise",o.address_components);locStreetNum=processAddressObject("street_number",o.address_components),locStreet=processAddressObject("route",o.address_components),t=t?t+", ":"";var n=(t+locStreetNum+" "+locStreet).trim();jQuery("input#locStAdr").val(n),processAddressObject("administrative_area3",o.address_components)&&(locCity=processAddressObject("administrative_area3",o.address_components)),processAddressObject("locality",o.address_components)&&(locCity=processAddressObject("locality",o.address_components)),processAddressObject("sublocality",o.address_components)&&(locCity=processAddressObject("sublocality",o.address_components)),processAddressObject("postal_town",o.address_components)&&(locCity=processAddressObject("postal_town",o.address_components)),jQuery("input#locCity").val(locCity.trim()),locRegion=processAddressObject("administrative_area_level_1",o.address_components),locRegion||(locRegion=processAddressObject("administrative_area_level_2",o.address_components)),""===locRegion&&null===locRegion||""!==locRegion&&null!==locRegion||(locRegion=locRegion),jQuery("#locCity").val(locCity.trim()),jQuery("#locRegion").val(locRegion.trim()),locPostcode=processAddressObject("postal_code",o.address_components),jQuery("#locPostcode").val(locPostcode),locCountry=processAddressObject("country",o.address_components),jQuery("#locCountry").val(locCountry),locAddress=locStreet+", "+locCity+", "+locRegion+", "+locPostcode+", "+locCountry}a()}function f(){if(jQuery("#search-report").is(":animated"))return!1;custom_location(),seed_vars(),locAddress=locName+"+"+locStreet+"+"+locCity+"+"+locRegion+"+"+locPostcode+"+"+locCountry,geocoder=new google.maps.Geocoder,h(function(){a(),e.open(map,marker)})}function h(e){var o="";geocoder.geocode({address:locAddress},function(n,a){if(a!==google.maps.GeocoderStatus.OK&&(o="Sorry, try adding more address details: "+a,t(o,"warning")),a===google.maps.GeocoderStatus.OK){locPlace=n[0],locName="",locStreetNum="",locStreet="",locCity="",locRegion="",locRegion="",locPostcode="",locCountry="",locIcon="",locGooglePlaceID="",locName=processAddressObject("point_of_interest",locPlace.address_components),""!==locName&&null!==locName&&jQuery("#locName").val(locName.trim());var r=processAddressObject("premise",locPlace.address_components);locStreetNum=processAddressObject("street_number",locPlace.address_components),locStreet=processAddressObject("route",locPlace.address_components),r=r?r+", ":"";var l=(r+locStreetNum+" "+locStreet).trim();jQuery("input#locStAdr").val(l),locCity=processAddressObject("postal_town",locPlace.address_components),locCity||(locCity=processAddressObject("locality",locPlace.address_components)),jQuery("input#locCity").val(locCity),locRegion=processAddressObject("administrative_area_level_1",locPlace.address_components),locRegion||(locRegion=processAddressObject("administrative_area_level_2",locPlace.address_components)),jQuery("input#locRegion").val(locRegion),locPostcode=processAddressObject("postal_code",locPlace.address_components),jQuery("input#locPostcode").val(locPostcode),locCountry=processAddressObject("country",locPlace.address_components),jQuery("input#locCountry").val(locCountry),locIcon=processAddressObject("icon",locPlace.address_components),jQuery("input#locCountry").val(locIcon),lat=locPlace.geometry.location.lat(),jQuery("input#mapLat").val(lat),lng=locPlace.geometry.location.lng(),jQuery("input#mapLng").val(lng),o="Geocoding successful,  Lng & Lat status: "+a,t(o,"confirm"),seed_vars(),e()}})}jQuery(function($){if(!1===tnygmaps_api)return void jQuery(".accordion").hide().prop("disabled",!0);jQuery(".noEnterSubmit").keypress(function(e){if(13===e.which)return!1}),o(jQuery(this)),jQuery(".accordion").hide(),jQuery(".heading").click(function(){if(jQuery(this).next().find(".accordion").hasClass("open"))return void jQuery(this).next().find(".open").removeClass("open active").slideUp(function(){jQuery("#button-dialog form").find("input:text").first().trigger("focus")});jQuery(".heading").not(this).next(".group").find(".accordion").slideUp(function(){jQuery(this).removeClass("open active"),o(jQuery(this))}),jQuery(this).next().find(".accordion").slideDown(400,function(){o(jQuery(this)),jQuery(this).addClass("open active")})}),jQuery("input[name='custom_use_address_check']").click(function(){jQuery(this).is(":checked")&&jQuery("#mapAddress-group").slideUp(400,function(){jQuery("#address_extras").find("input:text, button").addClass("active highlight").prop("disabled",!1).delay(700).show(1,function(){jQuery(this).removeClass("highlight")}),jQuery("#locName").trigger("focus")}),!1===jQuery(this).is(":checked")&&(jQuery("#mapAddress-group").slideDown(),jQuery("#address_extras").find("input:text, button").prop("disabled",!0).val("").removeClass("active"),jQuery(".autoMapAddress").parent().slideDown(400,function(){o(jQuery(this)),a()}))}),!1===parent.tnygmaps.haveGPlaces_key?(jQuery("#tnygmaps.haveGPlaces_key").remove(),jQuery("#address_extras").show(),jQuery("#address_extras").find("input:text, button").prop("disabled",!1)):jQuery("#address_extras").find("input:text, button").prop("disabled",!0),jQuery(".mapMarkerImage_wrap").hide(),jQuery("#mapMarker").change(function(){"Custom"===$("#mapMarker option:selected").text()?(jQuery(".mapMarkerImage_wrap").slideDown(),o(jQuery(this))):jQuery(".mapMarkerImage_wrap").slideUp()}),jQuery("button[id='clear-fields']").click(function(){if(jQuery("#search-report").is(":animated"))return!1;jQuery("#address_extras :input:not(input:checkbox)","div").val([]),t("Cleared!","confirm")}),jQuery(".map-icon").click(function(e){e.preventDefault();var o=jQuery(this).attr("title");jQuery("input#mapMarkerImage").val(parent.tnygmaps.plugin_icons_URL+o),y()}),jQuery(".fadeout").delay(2e3).fadeOut(800),jQuery("[data-tooltip !='']").qtip({position:{my:"top-left"},content:{attr:"data-tooltip"}}),l()});var j=document.getElementById("mapAddress"),w=new google.maps.places.Autocomplete(j);e=new google.maps.InfoWindow,a()}function htmlEntities(e){return String(e).replace(/&amp;/g,"&").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var lat=null,lng=null,mapZoomReturn=null,mapWidthReturn=null,mapHeightReturn=null,mapTypeReturn=null,mapControlsReturn=null,mapAddressReturn=null,locGooglePlaceID=null,mapMarkerReturn=null,mapMarkerImageReturn=null,infowindowPlace=null,mapInfoWindowReturn=null,tnyGmapsAssembleShortcode=null,map=null,marker=null,markerImage=null,mapOptions=null,mapCurrCenter=null,markerOutput=null,locPlace=null,markerCustom=parent.tnygmaps.custom_icon,locName=null,locStreet=null,locStreetNum=null,locCity=null,locRegion=null,locPostcode=null,locCountry=null,locWeb=null,locPhone=null,locIcon=null,locAddress=null,geocoder=null;String.prototype.trim||(String.prototype.trim=function(){"use strict";return this.replace(/^\s+|\s+$/g,"")}),google.maps.event.addDomListener(window,"load",initialize),tnyGmapsAssembleShortcode={local_ed:"ed",init:function(e){tnyGmapsAssembleShortcode.local_ed=e,tinyMCEPopup.resizeToInnerSize()},insert:function e(o){seed_vars(),mapInfoWindowReturn=htmlEntities(mapInfoWindowReturn),mapInfoWindowReturn=jQuery.base64.encode(mapInfoWindowReturn),markerOutput="[tnygmaps ",markerOutput+='z="'+mapZoomReturn+'" ',markerOutput+='w="'+mapWidthReturn+'" ',markerOutput+='h="'+mapHeightReturn+'" ',markerOutput+=!0===mapControlsReturn?markerOutput+='hidecontrols="true" ':"",null===locGooglePlaceID||""===locGooglePlaceID?(markerOutput+='lat="'+lat+'" ',markerOutput+='lng="'+lng+'" ',markerOutput+=""!==locName?'name="'+htmlEntities(locName)+'" ':"",markerOutput+=""!==locStreet?'street="'+htmlEntities(locStreet)+'" ':"",markerOutput+=""!==locCity?'city="'+htmlEntities(locCity)+'" ':"",markerOutput+=""!==locRegion?'region="'+htmlEntities(locRegion)+'" ':"",markerOutput+=""!==locPostcode?'postcode="'+htmlEntities(locPostcode)+'" ':"",markerOutput+=""!==locCountry?'country="'+htmlEntities(locCountry)+'" ':"",markerOutput+=""!==locWeb?'website="'+locWeb+'" ':"",markerOutput+=""!==locPhone?'phone="'+htmlEntities(locPhone)+'" ':"",markerOutput+=""!==locIcon?'icon="'+htmlEntities(locIcon)+'" ':""):markerOutput+='placeid="'+locGooglePlaceID+'" ',parent.tnygmaps.custom_icon===mapMarkerImageReturn?markerOutput+='default_marker="true" ':markerOutput+=""!==mapMarkerReturn&&""!==mapMarkerImageReturn?'marker="'+mapMarkerImageReturn+'" ':"",markerOutput+=""!==mapMarkerReturn&&""!==mapInfoWindowReturn?'infowindowb64="'+mapInfoWindowReturn+'" ':"",markerOutput+="]",tinyMCEPopup.execCommand("mceReplaceContent",!1,markerOutput),tinyMCEPopup.close()}},tinyMCEPopup.onInit.add(tnyGmapsAssembleShortcode.init,tnyGmapsAssembleShortcode);